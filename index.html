<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live Scores</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container">
    <h1>Live Scores</h1>
    <ul id="game-list"></ul>
</div>
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Function to update the game list with fetched data
    function updateGameList(games) {
        const gameList = document.getElementById('game-list');
        gameList.innerHTML = '';

        // Filter games played today
        const today = new Date().toISOString().slice(0, 10);
        const todayGames = games.filter(game => game.DateTime.includes(today));

        // Sort today's games by start time
        todayGames.sort((a, b) => {
            return new Date(a.DateTime) - new Date(b.DateTime);
        });

        todayGames.forEach(game => {
            if (game.Status === 'Scheduled') {
                const startTime = new Date(game.DateTime);
                const formattedTime = startTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const awayTeamLogo = game.AwayTeam.toLowerCase().replace(/ /g, '-') + '.png';
                const homeTeamLogo = game.HomeTeam.toLowerCase().replace(/ /g, '-') + '.png';

                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <img src="logos/${awayTeamLogo}" alt="${game.AwayTeam} Logo">
                    <span>${game.AwayTeam}</span>
                    <span>vs</span>
                    <span>${game.HomeTeam}</span>
                    <img src="logos/${homeTeamLogo}" alt="${game.HomeTeam} Logo">
                    <span>${formattedTime}</span>
                `;
                gameList.appendChild(listItem);
            } else if (game.Status === 'InProgress') {
                const awayTeamScore = game.AwayTeamScore !== null ? game.AwayTeamScore : '';
                const homeTeamScore = game.HomeTeamScore !== null ? game.HomeTeamScore : '';
                const awayTeamLogo = game.AwayTeam.toLowerCase().replace(/ /g, '-') + '.png';
                const homeTeamLogo = game.HomeTeam.toLowerCase().replace(/ /g, '-') + '.png';

                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <img src="logos/${awayTeamLogo}" alt="${game.AwayTeam} Logo">
                    <span>${game.AwayTeam} ${awayTeamScore}</span>
                    <span>-</span>
                    <span>${homeTeamScore} ${game.HomeTeam}</span>
                    <img src="logos/${homeTeamLogo}" alt="${game.HomeTeam} Logo">
                    <span>In Progress</span>
                `;
                gameList.appendChild(listItem);
            }
        });
    }

    // Function to fetch scores from the server
    function fetchScores() {
        fetch('fetch_scores.php')
            .then(response => response.json())
            .then(data => {
                updateGameList(data.games);
            })
            .catch(error => {
                console.error('Error fetching scores:', error);
            });
    }

    // Fetch scores initially and set interval for periodic updates
    fetchScores();
    setInterval(fetchScores, 30000); // Update every 30 seconds
});
</script>
</body>
</html>
